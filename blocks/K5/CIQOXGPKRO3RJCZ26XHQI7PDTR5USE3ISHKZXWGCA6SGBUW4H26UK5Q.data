
¿·#

mfspath="$1"
fname=${mfspath##*/}
tmpf=/tmp/$fname
pv=$(ipfs files stat --hash $mfspath)
ipfs files read $mfspath > $tmpf
gvim --servername MFS --remote-wait-tab-silent $tmpf
sed -i "s/\$Previous: .*\$/\$Previous: $pv\$/" $tmpf
qm=$(ipfs add -Q $tmpf)
ipfs files rm $mfspath $mfspath~ 2>/dev/null
ipfs files mv $mfspath $mfspath~
ipfs files cp /ipfs/$qm $mfspath
ipfs files stat $mfspath


exit $?; # $Source: /my/shell/scripts/vimfs$

·